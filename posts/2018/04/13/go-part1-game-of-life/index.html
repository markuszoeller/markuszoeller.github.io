<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Learning Go (part 1) - Conwayâ€™s Game of Life &#8212; Markus Zoeller Blog</title>
    
    <link rel="stylesheet" href="../../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/css/asciinema-player.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/asciinema-player.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../../../about/" />
    <link rel="index" title="Index" href="../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../search/" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  <link rel="alternate" type="application/atom+xml"  href="../../../../../posts/atom.xml" title="Markus's Brain Swap Space">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../../">
          MZIO</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../../../about/">About</a></li>
                <li><a href="../../../../category/">Categories</a></li>
                <li><a href="../../../../tag/">Tags</a></li>
                <li><a href="../../../../archive/">Archive</a></li>
                <li><a href="/posts/atom.xml"><i class='fa fa-rss-square' aria-hidden='true'></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../../">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../../search/" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="learning-g-part-1-conway-s-game-of-life">
<h1>Learning <em>Go</em> (part 1) - Conway&#8217;s Game of Life<a class="headerlink" href="#learning-g-part-1-conway-s-game-of-life" title="Permalink to this headline"> </a></h1>
<p>The <em>Go</em> programming language is currently fashionable, and it&#8217;s been four
years since the last time I started to learn a new programming language
(<em>Python</em>), so I decided to start a series about my learning attempts.
As I also want to know more about <em>Kubernetes</em>, my goal is to
learn enough <em>Go</em> in the next few months to read the <em>Kubernetes</em> code base
comfortably. As a starting point for this multi-part series, I&#8217;ve chosen
<em>Conway&#8217;s Game of Life</em> <a class="footnote-reference" href="#cgol" id="id1">[1]</a>, because its rules are simple but more
complex than a typical <em>hello world</em> example.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#installing-the-latest-g-runtime" id="id6">Installing the latest <em>Go</em> runtime</a></li>
<li><a class="reference internal" href="#setting-up-the-project" id="id7">Setting up the project</a></li>
<li><a class="reference internal" href="#writing-the-functional-code" id="id8">Writing the functional code</a></li>
<li><a class="reference internal" href="#writing-the-unit-tests" id="id9">Writing the unit tests</a></li>
<li><a class="reference internal" href="#format-test-and-build-the-project" id="id10">Format, test and build the project</a></li>
<li><a class="reference internal" href="#summary-and-next-steps" id="id11">Summary and next steps</a></li>
<li><a class="reference internal" href="#references" id="id12">References</a></li>
</ul>
</div>
<table border="1" class="docutils" id="id5">
<caption><span class="caption-text">Change history:</span><a class="headerlink" href="#id5" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Date</th>
<th class="head">Change description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2018-04-13</td>
<td>The first release</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As this is a learning endeavor, there will be mistakes.
Don&#8217;t confuse the code below with any kind of actual recommendation.</p>
</div>
<div class="section" id="installing-the-latest-g-runtime">
<h2><a class="toc-backref" href="#contents">Installing the latest <em>Go</em> runtime</a><a class="headerlink" href="#installing-the-latest-g-runtime" title="Permalink to this headline"> </a></h2>
<p>The installation of the <em>Go</em> runtime <a class="footnote-reference" href="#goinstall" id="id2">[2]</a> is coded in the following
<em>Ansible</em> playbook:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="l l-Scalar l-Scalar-Plain">become</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">apt</span><span class="nv"> </span><span class="s">cache</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">updated.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">apt</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">update_cache</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">cache_valid_time</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">3600</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">basic</span><span class="nv"> </span><span class="s">build</span><span class="nv"> </span><span class="s">tools</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">installed.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">apt</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gcc,make</span>
        <span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">present</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">(old)</span><span class="nv"> </span><span class="s">OS</span><span class="nv"> </span><span class="s">packaged</span><span class="nv"> </span><span class="s">GO</span><span class="nv"> </span><span class="s">lang</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">NOT</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">available.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">apt</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">golang-go</span>
        <span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">working</span><span class="nv"> </span><span class="s">directory</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">GO</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">created.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">file</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_env.HOME</span><span class="nv"> </span><span class="s">}}/go&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">directory</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">GO</span><span class="nv"> </span><span class="s">lang</span><span class="nv"> </span><span class="s">archive</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">downloaded</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">extracted.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">unarchive</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">src</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">https://dl.google.com/go/go1.9.3.linux-amd64.tar.gz</span>
        <span class="l l-Scalar l-Scalar-Plain">dest</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/local/</span>
        <span class="l l-Scalar l-Scalar-Plain">remote_src</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">yes</span>
        <span class="l l-Scalar l-Scalar-Plain">creates</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/usr/local/go/bin/go</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;The</span><span class="nv"> </span><span class="s">GO</span><span class="nv"> </span><span class="s">PATHs</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">globally.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">lineinfile</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">path</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/etc/profile</span>
        <span class="l l-Scalar l-Scalar-Plain">line</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item</span><span class="nv"> </span><span class="s">}}&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">with_items</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GOPATH=$HOME/go</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">PATH=$PATH:/usr/local/go/bin</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GOROOT=$HOME/go</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GOBIN=$HOME/go/bin</span>
</pre></div>
</td></tr></table></div>
<p>This is only one way of doing it, and it&#8217;s not necessary to have the
latest greatest for the code below.</p>
</div>
<div class="section" id="setting-up-the-project">
<h2><a class="toc-backref" href="#contents">Setting up the project</a><a class="headerlink" href="#setting-up-the-project" title="Permalink to this headline"> </a></h2>
<p>We need a unique package name for our code, to avoid import clashes <a class="footnote-reference" href="#imp" id="id3">[3]</a>.
The recommendation for code which will live on <em>Github</em> looks like this:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ mkdir -p <span class="nv">$GOPATH</span>/src/github.com/markuszoeller/cgol
</pre></div>
</td></tr></table></div>
<p>Later, when we build the source code, it will be added to the <code class="docutils literal"><span class="pre">pkg</span></code>
directory, and we get this structure:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span>root@golang:~/go# tree
.
<span class="p">|</span>-- pkg
<span class="p">|</span>   <span class="sb">`</span>-- linux_amd64
<span class="p">|</span>       <span class="sb">`</span>-- github.com
<span class="p">|</span>           <span class="sb">`</span>-- markuszoeller
<span class="p">|</span>               <span class="sb">`</span>-- cgol.a
<span class="sb">`</span>-- src
    <span class="sb">`</span>-- github.com
        <span class="sb">`</span>-- markuszoeller
            <span class="sb">`</span>-- cgol
                <span class="p">|</span>-- cells.go
                <span class="sb">`</span>-- cells_test.go
</pre></div>
</td></tr></table></div>
<p>One interesting thing to notice is, that the test code lives in the very
same directory of the functional code, and <em>Go</em> ignores that test code
when building the source.</p>
</div>
<div class="section" id="writing-the-functional-code">
<h2><a class="toc-backref" href="#contents">Writing the functional code</a><a class="headerlink" href="#writing-the-functional-code" title="Permalink to this headline"> </a></h2>
<p>Before we dive into the code, here&#8217;s a short recap of the rules of
<em>Conway&#8217;s Game of Life</em>, straight from <em>Wikipedia</em> <a class="footnote-reference" href="#cgol" id="id4">[1]</a>:</p>
<blockquote>
<div>Any live cell with fewer than two live neighbours dies, as if caused by
underpopulation. Any live cell with two or three live neighbours lives
on to the next generation. Any live cell with more than three live
neighbours dies, as if by overpopulation. Any dead cell with exactly
three live neighbours becomes a live cell, as if by reproduction.</div></blockquote>
<p>I&#8217;ve decided to go with the simplest solution I could think of,
a two-dimensional array of boolean values which represent the cells
in my world. A <code class="docutils literal"><span class="pre">true</span></code> value is a cell which is alive, a <code class="docutils literal"><span class="pre">false</span></code> value
is a cell which is dead:</p>
<div class="highlight-go"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">cells</span>

<span class="kd">var</span> <span class="nx">world</span> <span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="kt">bool</span>

<span class="kd">func</span> <span class="nx">resetWorld</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">// world = [10][10]bool  # doesn&#39;t work</span>
	<span class="k">for</span> <span class="nx">row</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">row</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">world</span><span class="p">);</span> <span class="nx">row</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">for</span> <span class="nx">col</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">col</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">world</span><span class="p">[</span><span class="nx">row</span><span class="p">]);</span> <span class="nx">col</span><span class="o">++</span> <span class="p">{</span>
			<span class="nx">world</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="p">=</span> <span class="kc">false</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">resurrectCell</span><span class="p">(</span><span class="nx">row</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">col</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">world</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="p">=</span> <span class="kc">true</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">killCell</span><span class="p">(</span><span class="nx">row</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">col</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">world</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="p">=</span> <span class="kc">false</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">col</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">world</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">getAliveNeighbours</span><span class="p">(</span><span class="nx">row</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">col</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="nx">count</span> <span class="o">:=</span> <span class="mi">0</span>
	<span class="c1">// count += int(getCell(row-1, col-1))  # does not work</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">col</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">col</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">col</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">col</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">col</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">col</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">count</span><span class="o">++</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nx">count</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">getNextGenState</span><span class="p">(</span><span class="nx">row</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">col</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
	<span class="nx">alive</span> <span class="o">:=</span> <span class="nx">getCell</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">)</span>
	<span class="nx">alive_neighbours</span> <span class="o">:=</span> <span class="nx">getAliveNeighbours</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">)</span>

	<span class="k">if</span> <span class="nx">alive</span> <span class="o">&amp;&amp;</span> <span class="nx">alive_neighbours</span> <span class="p">&lt;</span> <span class="mi">2</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">alive</span> <span class="o">&amp;&amp;</span> <span class="nx">alive_neighbours</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">alive_neighbours</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">true</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">alive</span> <span class="o">&amp;&amp;</span> <span class="nx">alive_neighbours</span> <span class="p">&gt;</span> <span class="mi">3</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">!(</span><span class="nx">alive</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">alive_neighbours</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">true</span>
	<span class="p">}</span>

	<span class="c1">// should not happen</span>
	<span class="k">return</span> <span class="kc">false</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>A few things to notice here:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">world</span> <span class="pre">=</span> <span class="pre">[10][10]bool</span></code> was an attempt to reset all values to <code class="docutils literal"><span class="pre">false</span></code>
for the tests, but I couldn&#8217;t make it work, so I took the dummy approach
by iterating over all rows and columns of my world.</li>
<li><code class="docutils literal"><span class="pre">row</span> <span class="pre">:=</span> <span class="pre">0</span></code> shows the shorthand for variable definition and
value assignment. It&#8217;s equivalent to <code class="docutils literal"><span class="pre">var</span> <span class="pre">row</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></code>.</li>
<li>I didn&#8217;t find a built-in way to convert the boolean value to an Integer
value, so <code class="docutils literal"><span class="pre">count</span> <span class="pre">+=</span> <span class="pre">int(getCell(row-1,</span> <span class="pre">col-1))</span></code> didn&#8217;t work, therefore
I used those ugly conditionals. <em>Go</em> doesn&#8217;t seem to have a ternary operator
or any other way to do that in one line.</li>
<li>Declaring <code class="docutils literal"><span class="pre">bool</span></code> as a return type of a function didn&#8217;t allow me to
return <code class="docutils literal"><span class="pre">nil</span></code> (the &#8220;nothing&#8221; of <em>Go</em>), so I used <code class="docutils literal"><span class="pre">false</span></code> at the end.</li>
<li><code class="docutils literal"><span class="pre">!(alive)</span></code> shows an example of boolean negation. In Python it would
look like <code class="docutils literal"><span class="pre">not</span> <span class="pre">alive</span></code>.</li>
</ul>
</div>
<div class="section" id="writing-the-unit-tests">
<h2><a class="toc-backref" href="#contents">Writing the unit tests</a><a class="headerlink" href="#writing-the-unit-tests" title="Permalink to this headline"> </a></h2>
<p>Let&#8217;s test what we have so far:</p>
<div class="highlight-go"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">cells</span>

<span class="kn">import</span> <span class="s">&quot;testing&quot;</span>

<span class="kd">func</span> <span class="nx">TestResurrectAndKillCell</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">resetWorld</span><span class="p">()</span> <span class="c1">// there is no builtin `setup` and `teardown`</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Should be alive&quot;</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="nx">killCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">getCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="kc">true</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Should be dead&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">TestGetAliveNeighbours</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">resetWorld</span><span class="p">()</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="nx">count</span> <span class="o">:=</span> <span class="nx">getAliveNeighbours</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">count</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Should be exactly 0&quot;</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
	<span class="nx">count</span> <span class="p">=</span> <span class="nx">getAliveNeighbours</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">count</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Should be exactly 1&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">TestGetNextGenStateUnderPopulation</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">resetWorld</span><span class="p">()</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">alive</span> <span class="o">:=</span> <span class="nx">getNextGenState</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">alive</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;3,7 Should be dead because of under population&quot;</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">alive</span> <span class="p">=</span> <span class="nx">getNextGenState</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">alive</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;3,7 Should be dead because of under population&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">TestGetNextGenStateOkayPopulation</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">resetWorld</span><span class="p">()</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">alive</span> <span class="o">:=</span> <span class="nx">getNextGenState</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">!(</span><span class="nx">alive</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;4,7 Should be alive&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">TestGetNextGenStateOverPopulation</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">resetWorld</span><span class="p">()</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="nx">alive</span> <span class="o">:=</span> <span class="nx">getNextGenState</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">alive</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;4,7 Should be dead&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">TestGetNextGenStateReproduction</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">resetWorld</span><span class="p">()</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
	<span class="nx">resurrectCell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
	<span class="nx">alive</span> <span class="o">:=</span> <span class="nx">getNextGenState</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">!(</span><span class="nx">alive</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">t</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;4,7 Should be alive&quot;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Things to notice are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">t</span> <span class="pre">*testing.T</span></code> is the one parameter every test function needs to
accept to have access to the built-in testing framework. I&#8217;m not quite
sure how to read it, but I guess it means we accept a reference (<code class="docutils literal"><span class="pre">*</span></code>) to
an instance of the class <code class="docutils literal"><span class="pre">T</span></code> in package <code class="docutils literal"><span class="pre">testing</span></code> and store it in
parameter <code class="docutils literal"><span class="pre">t</span></code>.</li>
<li>I didn&#8217;t find a built-in way of executing code before and after every
test function, like <code class="docutils literal"><span class="pre">setup</span></code> and <code class="docutils literal"><span class="pre">teardown</span></code>, which are known from
other XUnit testing frameworks. Honestly, this was quite odd to me.
This forced me to reset the world with <code class="docutils literal"><span class="pre">resetWorld()</span></code> in each test
method. Very odd.</li>
<li>Other XUnit frameworks I used in the past usually had assertion methods
like <code class="docutils literal"><span class="pre">assertEqual</span></code> or <code class="docutils literal"><span class="pre">assertTrue</span></code>. <em>Go</em> doesn&#8217;t have that. Nothing
stops you to implement that yourself as convenience methods, but I was
very surprised to not find it built-in.</li>
</ul>
</div>
<div class="section" id="format-test-and-build-the-project">
<h2><a class="toc-backref" href="#contents">Format, test and build the project</a><a class="headerlink" href="#format-test-and-build-the-project" title="Permalink to this headline"> </a></h2>
<p>Finally, we can check that our code is formatted like expected with
<code class="docutils literal"><span class="pre">go</span> <span class="pre">fmt</span></code>, then we execute the tests with <code class="docutils literal"><span class="pre">go</span> <span class="pre">test</span></code> and at last
we build the project with <code class="docutils literal"><span class="pre">go</span> <span class="pre">build</span></code>:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ go fmt
$ go <span class="nb">test</span>
$ go build
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">go</span> <span class="pre">fmt</span></code> command, which seems to be the authoritative source of how
the source code should be formatted, replaced all my spaces by tabs.
Frankly, I thought the whole fight about tabs versus spaces for formatting
source code was over and the usage of spaces won. Apparently I was wrong.
But I wasted too many hours of my life discussing that, so I just accept
it that <em>Go</em> decided to do it this way.</p>
</div>
<div class="section" id="summary-and-next-steps">
<h2><a class="toc-backref" href="#contents">Summary and next steps</a><a class="headerlink" href="#summary-and-next-steps" title="Permalink to this headline"> </a></h2>
<p>This post showed only how to write basic library code in a very basic way.
In the next post of this series, I&#8217;d like to add a CLI which imports the
library, takes some user input and then displays some generations of the
cells, according the rules we specified.</p>
<p>Learning more about the object oriented side of <em>Go</em> is definitely also
something on my plate. Note sure if will be already in the next post of this
series, as I expect it to be a bit more complex.</p>
<p>It&#8217;s too early for me to make a statement about how I feel about <em>Go</em>.
The next posts will explore more things and most likely uncover some
mistakes I made in this post here. Time will tell.</p>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#contents">References</a><a class="headerlink" href="#references" title="Permalink to this headline"> </a></h2>
<table class="docutils footnote" frame="void" id="cgol" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> <a class="reference external" href="https://en.wikipedia.org/wiki/Conway's_Game_of_Life">https://en.wikipedia.org/wiki/Conway&#8217;s_Game_of_Life</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="goinstall" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="https://golang.org/doc/install">https://golang.org/doc/install</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="imp" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="https://golang.org/doc/code.html#ImportPaths">https://golang.org/doc/code.html#ImportPaths</a></td></tr>
</tbody>
</table>
</div>
</div>

  <div class="section">
  
    


  
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015-2018, Markus Zoeller.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>