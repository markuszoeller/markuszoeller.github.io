<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Elastic Stack (formerly ELK) - Elasticsearch &#8212; Markus Zoeller Blog</title>
    
    <link rel="stylesheet" href="../../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/css/asciinema-player.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/asciinema-player.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../../../about/" />
    <link rel="index" title="Index" href="../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../search/" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  
  <link rel="alternate" type="application/atom+xml"  href="../../../../../posts/atom.xml" title="Markus's Brain Swap Space">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../../">
          MZIO</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../../../about/">About</a></li>
                <li><a href="../../../../category/">Categories</a></li>
                <li><a href="../../../../tag/">Tags</a></li>
                <li><a href="../../../../archive/">Archives</a></li>
                <li><a href="/posts/atom.xml"><i class='fa fa-rss-square' aria-hidden='true'></i></a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../../">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../../search/" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="elastic-stack-formerly-elk-elasticsearch">
<h1>Elastic Stack (formerly ELK) - <em>Elasticsearch</em><a class="headerlink" href="#elastic-stack-formerly-elk-elasticsearch" title="Permalink to this headline"> </a></h1>
<p>When something goes wrong in an environment, the people trying to fix it
mostly start by looking at the log files persisted on the local filesystem
of the server. This gets more cumbersome the more server and services
participate. Highly distributed applications, developed and deployed as
microservices in a cloud environment exacerbate this too. A centralized
logging server helps to ease the pain. In this post I&#8217;ll talk about the
popular <em>Elasticsearch</em> service, which is part of the <em>Elastic Stack</em>, formerly known
as <em>ELK</em> stack.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#intro" id="id17">Intro</a></li>
<li><a class="reference internal" href="#set-up-the-environment" id="id18">Set up the environment</a></li>
<li><a class="reference internal" href="#terms-and-concepts" id="id19">Terms and Concepts</a></li>
<li><a class="reference internal" href="#basic-interaction-with-es" id="id20">Basic Interaction with <em>Elasticsearch</em></a><ul>
<li><a class="reference internal" href="#health-check" id="id21">Health Check</a></li>
<li><a class="reference internal" href="#list-nodes" id="id22">List Nodes</a></li>
<li><a class="reference internal" href="#minimal-example" id="id23">Minimal Example</a></li>
<li><a class="reference internal" href="#list-indices" id="id24">List Indices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging-to-es" id="id25">Logging to <em>Elasticsearch</em></a><ul>
<li><a class="reference internal" href="#interact-with-our-app" id="id26">Interact with our app</a></li>
<li><a class="reference internal" href="#search-our-log-entries" id="id27">Search our log entries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary" id="id28">Summary</a></li>
<li><a class="reference internal" href="#references" id="id29">References</a></li>
</ul>
</div>
<table border="1" class="docutils" id="id16">
<caption><span class="caption-text">Change history:</span><a class="headerlink" href="#id16" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Date</th>
<th class="head">Change description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2018-01-05</td>
<td>The first release</td>
</tr>
</tbody>
</table>
<div class="section" id="intro">
<h2><a class="toc-backref" href="#contents">Intro</a><a class="headerlink" href="#intro" title="Permalink to this headline"> </a></h2>
<p>This is the first part of a multi-part series about the
<em>Elastic Stack</em> (formerly the <strong>ELK stack</strong>). This stack
consists of 3 parts:</p>
<ul class="simple">
<li><strong>storing data</strong> with <em>Elasticsearch</em></li>
<li><strong>ingesting data</strong> with <em>Logstash</em> (and/or <em>Beats</em>)</li>
<li><strong>visualizing data</strong> with <em>Kibana</em></li>
</ul>
<p>This post will focus on the first part, <em>Elasticsearch</em>, which uses a schema-less,
flexible data model, often called <strong>document based</strong>. This means you
can use your current data as-is and don&#8217;t have to transform
it into another schema so that <em>Elasticsearch</em> can deal with it.</p>
<p>This post will focus on the <strong>log storage and query</strong> part and
won&#8217;t delve into metrics analytics or other use cases you can
implement with <em>Elasticsearch</em>. We will also not talk about the <em>x-pack</em> plugins,
which would add more functionality.</p>
</div>
<div class="section" id="set-up-the-environment">
<span id="sec-env"></span><h2><a class="toc-backref" href="#contents">Set up the environment</a><a class="headerlink" href="#set-up-the-environment" title="Permalink to this headline"> </a></h2>
<p>To reproduce the steps in this post, you need to have installed locally:</p>
<ul class="simple">
<li><em>Vagrant</em> <a class="footnote-reference" href="#vagrinst" id="id1">[1]</a></li>
<li><em>Ansible</em> <a class="footnote-reference" href="#ansinst" id="id2">[2]</a></li>
<li><em>VirtualBox</em> <a class="footnote-reference" href="#vbinst" id="id3">[3]</a></li>
</ul>
<p>After these <strong>prerequisites</strong> are fulfilled:</p>
<ol class="arabic simple">
<li>download the compressed
<a class="reference download internal" href="../../../../../_downloads/elastic-stack-elk-elasticsearch.tar.gz" download=""><code class="xref download docutils literal"><span class="pre">project</span> <span class="pre">source</span> <span class="pre">files</span></code></a>.</li>
<li>extract the archive</li>
<li>change to the <code class="docutils literal"><span class="pre">env</span></code> directory</li>
<li>start the <em>Vagrant</em> setup</li>
<li>use <em>Ansible</em> to configure the environment</li>
</ol>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ wget http://www.markusz.io/_downloads/elastic-stack-elk-elasticsearch.tar.gz
$ tar -zxvf elastic-stack-elk-elasticsearch.tar.gz
$ <span class="nb">cd</span> env
$ vagrant up
$ ansible-playbook playbook.yml
</pre></div>
</td></tr></table></div>
<p>Your (truncated) output should look similar to this:</p>
<div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span>[...]

PLAY RECAP ********************************************************************
app1                       : ok=10   changed=6    unreachable=0    failed=0
app2                       : ok=10   changed=6    unreachable=0    failed=0
es1                        : ok=21   changed=17   unreachable=0    failed=0

Thursday 04 January 2018  16:29:04 +0100 (0:00:01.319)       0:02:06.741 ******
===============================================================================
Install python package manager. ---------------------------------------- 50.79s
Install JAVA runtime. -------------------------------------------------- 24.73s
Check if Elasticsearch is up an running. ------------------------------- 11.50s
Wait for SSH to be ready. ---------------------------------------------- 10.36s
Download file with checksum check. -------------------------------------- 9.31s
Install app requirements. ----------------------------------------------- 4.87s
Ensure system package cache is updated. --------------------------------- 4.46s
Unarchive the elasticsearch archive. ------------------------------------ 1.43s
Run example app. -------------------------------------------------------- 1.32s
Run elasticsearch as daemon. -------------------------------------------- 1.22s
Add our servers to the hosts file. -------------------------------------- 0.99s
Deploy example app to servers. ------------------------------------------ 0.88s
Ping each other via DNS names. ------------------------------------------ 0.77s
Gather some facts for later. -------------------------------------------- 0.62s
Creating user for Elasticsearch group. ---------------------------------- 0.37s
Create a group for Elasticsearch. --------------------------------------- 0.32s
Disable all swapping. --------------------------------------------------- 0.32s
Create logging directory. ----------------------------------------------- 0.31s
Set maximum number of memory map areas (permanently). ------------------- 0.29s
Set number of open file descriptors (permanently). ---------------------- 0.28s
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">After you decided that you don&#8217;t need this environment anymore,
you can remove it with <code class="docutils literal"><span class="pre">vagrant</span> <span class="pre">destroy</span> <span class="pre">-f</span></code></p>
</div>
<p>This created a <strong>virtualized environment</strong> which looks like this:</p>
<a class="reference internal image-reference" href="../../../../../_images/elasticsearch-env-nF4AMyX.svg"><img alt="*Vagrant* environment with virtual machines." src="../../../../../_images/elasticsearch-env-nF4AMyX.svg" /></a>
<ul class="simple">
<li>one central logging server <code class="docutils literal"><span class="pre">es1</span></code></li>
<li>two application servers <code class="docutils literal"><span class="pre">app1</span></code> and <code class="docutils literal"><span class="pre">app2</span></code></li>
<li><em>Ubuntu 16.04</em> as operating system</li>
<li>Java <em>Open JDK</em> in version 8</li>
<li><em>Elasticsearch</em> in version 6.1</li>
</ul>
<p>While the setup goes on for a minute or two, let&#8217;s have a look at
a few basic terms and concepts of <em>Elasticsearch</em>.</p>
</div>
<div class="section" id="terms-and-concepts">
<span id="sec-concepts"></span><h2><a class="toc-backref" href="#contents">Terms and Concepts</a><a class="headerlink" href="#terms-and-concepts" title="Permalink to this headline"> </a></h2>
<p>Let&#8217;s start with an overview of the basic <strong>concepts</strong> <a class="footnote-reference" href="#concepts" id="id4">[4]</a>.
I&#8217;ll explain the details after this image:</p>
<a class="reference internal image-reference" href="../../../../../_images/elasticsearch-concepts-YfYunTY.svg"><img alt="The basic terms and concepts in |es|" src="../../../../../_images/elasticsearch-concepts-YfYunTY.svg" /></a>
<p>The main entity we&#8217;re interested in is the <strong>Document</strong>. This is the
schema-less entity we want to store in <em>Elasticsearch</em>. In our case, as this post
focuses on centralized logging, this is one single log entry.</p>
<p><em>Elasticsearch</em> stores <em>Documents</em> in an <strong>Index</strong> and every <em>Index</em> can store multiple
<em>Documents</em>. The <em>Index</em> is the entity which provides the ability to search
<em>Document</em> objects.</p>
<p>Each <em>Elasticsearch</em> service is considered a <strong>Node</strong>. This <em>Node</em> is not necessarily
bound to one hardware server or virtual machine. Each <em>Node</em> is in other
words, an <em>Elasticsearch</em> instance. Each one can have 0 to N <em>Index</em> objects to
scale out the management of <em>Document</em> objects.</p>
<p>For further horizontal scale out, each <em>Node</em> can be part of a <strong>Cluster</strong>.
Each <em>Cluster</em> consists of 1 to N <em>Node</em> objects. A single-node setup is
still a <em>Cluster</em> (with only 1 <em>Node</em>). There are <em>master nodes</em> in a
cluster, which determine how information gets replicated, but I won&#8217;t
dive into it in this post.</p>
<p>As described before, an <em>Index</em> is the (abstract) entity which stores
our documents. To be precise, an <em>Index</em> consists of <strong>Shards</strong>. These
<em>Shard</em> objects are <em>Index</em> objects themselves and can therefore store
<em>Documents</em>. This concept enables splitting out the <em>Documents</em> into
smaller segments. One <em>Shard</em> is in fact the <em>Lucene Index</em> <a class="footnote-reference" href="#lucene" id="id5">[5]</a>,
the search engine encapsulated by <em>Elasticsearch</em>. Such <em>shards</em> can be called
<strong>primary shards</strong>.</p>
<p>The <em>Shard</em> objects can be replicated (copied) into so called <strong>Replica</strong>
entities (or <strong>replica shards</strong>). A set of <em>Replica</em> objects are collected
in a <strong>Replication Group</strong>. Those <em>replica shards</em> enable
<em>High Availability (HA)</em> and <em>Data Recovery (DR)</em>. Hopefully I can
dive deeper into these capabilities in a later post.</p>
<p>After these basic terms and concepts are described, let&#8217;s finally
interact with <em>Elasticsearch</em> in our environment.</p>
</div>
<div class="section" id="basic-interaction-with-es">
<h2><a class="toc-backref" href="#contents">Basic Interaction with <em>Elasticsearch</em></a><a class="headerlink" href="#basic-interaction-with-es" title="Permalink to this headline"> </a></h2>
<p>After the setup by the <em>Ansible playbook</em>, we can interact with the
<strong>REST API</strong> of <em>Elasticsearch</em> via <code class="docutils literal"><span class="pre">curl</span></code> on our local machine. Port <code class="docutils literal"><span class="pre">9200</span></code> is
the default:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl <span class="m">192</span>.168.78.11:9200
<span class="o">{</span>
<span class="hll">  <span class="s2">&quot;name&quot;</span> : <span class="s2">&quot;hMDFApt&quot;</span>,
</span><span class="hll">  <span class="s2">&quot;cluster_name&quot;</span> : <span class="s2">&quot;elasticsearch&quot;</span>,
</span>  <span class="s2">&quot;cluster_uuid&quot;</span> : <span class="s2">&quot;kEM4Oz-PQQ-98ZgdOxGOdw&quot;</span>,
  <span class="s2">&quot;version&quot;</span> : <span class="o">{</span>
<span class="hll">    <span class="s2">&quot;number&quot;</span> : <span class="s2">&quot;6.1.1&quot;</span>,
</span>    <span class="s2">&quot;build_hash&quot;</span> : <span class="s2">&quot;bd92e7f&quot;</span>,
    <span class="s2">&quot;build_date&quot;</span> : <span class="s2">&quot;2017-12-17T20:23:25.338Z&quot;</span>,
    <span class="s2">&quot;build_snapshot&quot;</span> : false,
<span class="hll">    <span class="s2">&quot;lucene_version&quot;</span> : <span class="s2">&quot;7.1.0&quot;</span>,
</span>    <span class="s2">&quot;minimum_wire_compatibility_version&quot;</span> : <span class="s2">&quot;5.6.0&quot;</span>,
    <span class="s2">&quot;minimum_index_compatibility_version&quot;</span> : <span class="s2">&quot;5.0.0&quot;</span>
  <span class="o">}</span>,
  <span class="s2">&quot;tagline&quot;</span> : <span class="s2">&quot;You Know, for Search&quot;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>This JSON response shows a few things of the previous section:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">name</span></code>: The name of the <em>Node</em>. I used the default, which randomly
generates a unique one. This is configurable.</li>
<li><code class="docutils literal"><span class="pre">cluster_name</span></code>: The name of the <em>Cluster</em> this <em>Node</em> is in.
Again, I used the default name.</li>
<li><code class="docutils literal"><span class="pre">number</span></code>: The version of the <em>Elasticsearch</em> <em>Node</em>.</li>
<li><code class="docutils literal"><span class="pre">lucene_version</span></code>: The version of the search engine
encapsulated by <em>Elasticsearch</em>.</li>
</ul>
<p>The <strong>REST API</strong> has some useful <strong>common options</strong> <a class="footnote-reference" href="#commonapi" id="id6">[6]</a>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pretty=true</span></code>: to beautify the JSON output</li>
<li><code class="docutils literal"><span class="pre">format=yaml</span></code>: use YAML instead of JSON as output</li>
<li><code class="docutils literal"><span class="pre">error_trace=true</span></code> to show a more verbose error trace</li>
<li><code class="docutils literal"><span class="pre">filter_path=&lt;values&gt;</span></code> to reduce the response</li>
</ul>
<p>We will use some of these later.</p>
<div class="section" id="health-check">
<h3><a class="toc-backref" href="#contents">Health Check</a><a class="headerlink" href="#health-check" title="Permalink to this headline"> </a></h3>
<p>Let&#8217;s do a basic health check of our single-node cluster.
We use <code class="docutils literal"><span class="pre">format=yaml</span></code> to have an output which is easier to read:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl <span class="m">192</span>.168.78.11:9200/_cat/health?format<span class="o">=</span>yaml
</pre></div>
</td></tr></table></div>
<p>The output, formatted as YAML:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span>---
- epoch: <span class="s2">&quot;1514998054&quot;</span>
  timestamp: <span class="s2">&quot;16:47:34&quot;</span>
  cluster: <span class="s2">&quot;elasticsearch&quot;</span>
<span class="hll">  status: <span class="s2">&quot;green&quot;</span>
</span>  node.total: <span class="s2">&quot;1&quot;</span>
  node.data: <span class="s2">&quot;1&quot;</span>
  shards: <span class="s2">&quot;0&quot;</span>
  pri: <span class="s2">&quot;0&quot;</span>
  relo: <span class="s2">&quot;0&quot;</span>
  init: <span class="s2">&quot;0&quot;</span>
  unassign: <span class="s2">&quot;0&quot;</span>
  pending_tasks: <span class="s2">&quot;0&quot;</span>
  max_task_wait_time: <span class="s2">&quot;-&quot;</span>
  active_shards_percent: <span class="s2">&quot;100.0%&quot;</span>
</pre></div>
</td></tr></table></div>
<p><em>Elasticsearch</em> uses a traffic light system with <em>green</em>, <em>yellow</em> and <em>red</em>.
As the <code class="docutils literal"><span class="pre">status</span></code> is <code class="docutils literal"><span class="pre">green</span></code>, we&#8217;re good, the node works fine.</p>
</div>
<div class="section" id="list-nodes">
<h3><a class="toc-backref" href="#contents">List Nodes</a><a class="headerlink" href="#list-nodes" title="Permalink to this headline"> </a></h3>
<p>Any real live production system which uses <em>Elasticsearch</em> will most likely have
a cluster with multiple nodes in it. In those setups it might come
in handy to list all nodes:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl <span class="m">192</span>.168.78.11:9200/_cat/nodes?format<span class="o">=</span>yaml
</pre></div>
</td></tr></table></div>
<p>The output, formatted as YAML:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="hll"><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ip</span><span class="p p-Indicator">:</span> <span class="s">&quot;192.168.78.11&quot;</span>
</span>  <span class="l l-Scalar l-Scalar-Plain">heap.percent</span><span class="p p-Indicator">:</span> <span class="s">&quot;6&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">ram.percent</span><span class="p p-Indicator">:</span> <span class="s">&quot;63&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="p p-Indicator">:</span> <span class="s">&quot;0&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">load_1m</span><span class="p p-Indicator">:</span> <span class="s">&quot;0.00&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">load_5m</span><span class="p p-Indicator">:</span> <span class="s">&quot;0.00&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">load_15m</span><span class="p p-Indicator">:</span> <span class="s">&quot;0.00&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">node.role</span><span class="p p-Indicator">:</span> <span class="s">&quot;mdi&quot;</span>
<span class="hll">  <span class="l l-Scalar l-Scalar-Plain">master</span><span class="p p-Indicator">:</span> <span class="s">&quot;*&quot;</span>
</span><span class="hll">  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;hMDFApt&quot;</span>
</span></pre></div>
</td></tr></table></div>
<p>Remember, we have a single-node system, so only this one should
get listed:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ip</span></code>: as described in the previous section <a class="reference internal" href="#sec-env"><span class="std std-ref">Set up the environment</span></a></li>
<li><code class="docutils literal"><span class="pre">master</span></code>: this node is a <em>master node</em> in this <em>cluster</em>.
I&#8217;ll dive deeper into that in a later post.</li>
<li><code class="docutils literal"><span class="pre">name</span></code>: the name of this <em>node</em></li>
</ul>
<p>If the cluster would contain more nodes, they would be shown here
with YAML list style (see <em>Block Sequence</em> at <a class="footnote-reference" href="#yamllist" id="id7">[7]</a>).</p>
</div>
<div class="section" id="minimal-example">
<h3><a class="toc-backref" href="#contents">Minimal Example</a><a class="headerlink" href="#minimal-example" title="Permalink to this headline"> </a></h3>
<p>Let&#8217;s create a very small document:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span> $ curl -X PUT <span class="s1">&#39;192.168.78.11:9200/my-index/my-type/1?pretty&#39;</span> <span class="se">\</span>
 -H <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\</span>
 -d <span class="s1">&#39;{</span>
<span class="s1">     &quot;my_document&quot; : &quot;my document content&quot;</span>
<span class="s1"> }&#39;</span>
</pre></div>
</td></tr></table></div>
<p>This HTTP PUT call does multiple things:</p>
<ul class="simple">
<li>it creates an <em>Index</em> called <code class="docutils literal"><span class="pre">my-index</span></code></li>
<li>it creates a <em>Type</em> in that <em>Index</em>, called <code class="docutils literal"><span class="pre">my-type</span></code></li>
<li>it adds the <em>Document</em> (the JSON for parameter <code class="docutils literal"><span class="pre">-d</span></code>) to that <em>Index</em></li>
<li>it assigns the ID <code class="docutils literal"><span class="pre">1</span></code> to that document</li>
<li>it increments the version number of that created (or updated) <em>Document</em></li>
<li>it specifies, that the HTTP response should be <code class="docutils literal"><span class="pre">pretty</span></code> json</li>
</ul>
<p>It becomes more clear when we look at the HTTP response:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;_index&quot;</span> <span class="p">:</span> <span class="s2">&quot;my-index&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;my-type&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;result&quot;</span> <span class="p">:</span> <span class="s2">&quot;created&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_shards&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;total&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nt">&quot;successful&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;failed&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;_seq_no&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nt">&quot;_primary_term&quot;</span> <span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Before going into more detail, let&#8217;s query this document with another
REST API call:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl -X GET <span class="s1">&#39;192.168.78.11:9200/my-index/my-type/1?pretty&#39;</span>
</pre></div>
</td></tr></table></div>
<p>This call gives us this JSON response:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;_index&quot;</span> <span class="p">:</span> <span class="s2">&quot;my-index&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;my-type&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="nt">&quot;_version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;found&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
<span class="hll">    <span class="nt">&quot;my_document&quot;</span> <span class="p">:</span> <span class="s2">&quot;my document content&quot;</span>
</span>  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>These are the basic steps to store and retrieve documents in <em>Elasticsearch</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For centralized logging, where log entries are considered immutable, the
versioning support is rather uninteresting. In case you got curious,
take a look at <a class="footnote-reference" href="#esversion" id="id8">[8]</a>.</p>
</div>
<p>It&#8217;s also worth nothing that the <strong>automatic index creation</strong> can be
disabled if you see the need for it <a class="footnote-reference" href="#esindexdis" id="id9">[9]</a>. You&#8217;re also allowed
to create your indices beforehand <a class="footnote-reference" href="#esindexcreate" id="id10">[10]</a>.</p>
</div>
<div class="section" id="list-indices">
<h3><a class="toc-backref" href="#contents">List Indices</a><a class="headerlink" href="#list-indices" title="Permalink to this headline"> </a></h3>
<p>Now that we have an (automatically created) index, we can query it:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl -X GET <span class="m">192</span>.168.78.11:9200/_cat/indices?format<span class="o">=</span>yaml
</pre></div>
</td></tr></table></div>
<p>Again, we use the <code class="docutils literal"><span class="pre">format=yaml</span></code> simply to have a more readable output:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">health</span><span class="p p-Indicator">:</span> <span class="s">&quot;yellow&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">status</span><span class="p p-Indicator">:</span> <span class="s">&quot;open&quot;</span>
<span class="hll">  <span class="l l-Scalar l-Scalar-Plain">index</span><span class="p p-Indicator">:</span> <span class="s">&quot;my-index&quot;</span>
</span>  <span class="l l-Scalar l-Scalar-Plain">uuid</span><span class="p p-Indicator">:</span> <span class="s">&quot;u4WB1ztWT1GVXGOI0OoJnQ&quot;</span>
<span class="hll">  <span class="l l-Scalar l-Scalar-Plain">pri</span><span class="p p-Indicator">:</span> <span class="s">&quot;5&quot;</span>
</span><span class="hll">  <span class="l l-Scalar l-Scalar-Plain">rep</span><span class="p p-Indicator">:</span> <span class="s">&quot;1&quot;</span>
</span>  <span class="l l-Scalar l-Scalar-Plain">docs.count</span><span class="p p-Indicator">:</span> <span class="s">&quot;1&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">docs.deleted</span><span class="p p-Indicator">:</span> <span class="s">&quot;0&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">store.size</span><span class="p p-Indicator">:</span> <span class="s">&quot;4.5kb&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">pri.store.size</span><span class="p p-Indicator">:</span> <span class="s">&quot;4.5kb&quot;</span>
</pre></div>
</td></tr></table></div>
<p>This is the one <em>Index</em> we created automatically by adding a
document to it previously.
We also see the impact of <em>primary shards</em> and <em>replication shards</em>
in this response, namely the fields <code class="docutils literal"><span class="pre">pri</span></code> and <code class="docutils literal"><span class="pre">rep</span></code>, as discussed
in the previous section <a class="reference internal" href="#sec-concepts"><span class="std std-ref">Terms and Concepts</span></a>.</p>
<p>Now that we know the basic interaction with <em>Elasticsearch</em>, let&#8217;s use it as
a centralized logging server in the next section.</p>
</div>
</div>
<div class="section" id="logging-to-es">
<h2><a class="toc-backref" href="#contents">Logging to <em>Elasticsearch</em></a><a class="headerlink" href="#logging-to-es" title="Permalink to this headline"> </a></h2>
<p>The <em>Ansible playbook</em> also deploy a <strong>small example application</strong> to
the application servers <code class="docutils literal"><span class="pre">app1</span></code> and <code class="docutils literal"><span class="pre">app2</span></code> of our environment.
It&#8217;s a <em>Python Flask</em> app <a class="footnote-reference" href="#flask" id="id11">[11]</a> which uses Python&#8217;s logging
library <a class="footnote-reference" href="#pylog" id="id12">[12]</a>. <em>Flask</em> enables us to create a REST API to interact
with the apps. The logging library gives us a means to write a custom
log handler which emits log records into <em>Elasticsearch</em>. Here&#8217;s the code first,
then I explain the important parts:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging.handlers</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">HOSTNAME</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>


<span class="c1"># ======================================================================</span>
<span class="c1"># Custom logging handler for Elasticsearch</span>
<span class="c1"># ======================================================================</span>
<span class="hll"><span class="k">class</span> <span class="nc">ElasticsearchHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">):</span>
</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ElasticsearchHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>

    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">}</span>
<span class="hll">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span>            <span class="s1">&#39;module&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">module</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">asctime</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">levelname</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
            <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="n">HOSTNAME</span><span class="p">,</span>
        <span class="p">}</span>
<span class="hll">        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
</span><span class="hll">                          <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span>
</span><span class="hll">                          <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span>        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Log record emit result: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>


<span class="c1"># ======================================================================</span>
<span class="c1"># Set up logging</span>
<span class="c1"># ======================================================================</span>
<span class="hll"><span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - &#39;</span>
</span>                              <span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="hll"><span class="n">http_handler</span> <span class="o">=</span> <span class="n">ElasticsearchHandler</span><span class="p">(</span><span class="s2">&quot;http://es1:9200/app/logs/&quot;</span><span class="p">)</span>
</span><span class="n">http_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="hll"><span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span><span class="s2">&quot;app.log&quot;</span><span class="p">,</span>
</span>                                                    <span class="n">maxBytes</span><span class="o">=</span><span class="mi">10240</span><span class="p">,</span>
                                                    <span class="n">backupCount</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">http_handler</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>


<span class="c1"># ======================================================================</span>
<span class="c1"># REST API with Flask</span>
<span class="c1"># ======================================================================</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World!</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="hll"><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/logging/debug&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">log_debug_message</span><span class="p">():</span>
</span><span class="hll">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;debug message&#39;</span><span class="p">)</span>
</span>    <span class="k">return</span> <span class="s2">&quot;Logged debug message.</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/logging/info&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">log_info_message</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;info message&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Logged info message.</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/logging/warning&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">log_warning_message</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;warning message&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Logged warning message</span><span class="se">\n</span><span class="s2">&quot;</span>


<span class="c1"># ======================================================================</span>
<span class="c1"># MAIN</span>
<span class="c1"># ======================================================================</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
<p>The class <code class="docutils literal"><span class="pre">ElasticsearchHandler</span></code> is a (very rudimentary) <strong>logging handler</strong>
which can be added to a logger. When the logger logs a record, the added
handlers can emit them to different targets. This class emits the log
record to our <em>node</em> on server <code class="docutils literal"><span class="pre">es1</span></code>.</p>
<p>This custom logging handler is also responsible for putting together the
<strong>payload</strong> to send to <em>Elasticsearch</em>. We use the <strong>requests</strong> package to call
the REST API of <em>Elasticsearch</em>, like we did earlier with <code class="docutils literal"><span class="pre">curl</span></code> commands.</p>
<p>We use a <code class="docutils literal"><span class="pre">Formatter</span></code> for our log records.</p>
<p>We configure the logging handler with an <em>Elasticsearch</em> <em>Index</em> and <em>Type</em> by
specifying the URL <code class="docutils literal"><span class="pre">/app/logs/</span></code>. This means, an <em>Index</em> <code class="docutils literal"><span class="pre">app</span></code> gets
automatically created if it doesn&#8217;t exist yet.</p>
<p>As we don&#8217;t want to rely on the centralized logging only, which might
suffer from intermittent network connectivity issues, we log into a
file on the local filesystem too. There will be a rotated log file
<code class="docutils literal"><span class="pre">app.log</span></code> <a class="footnote-reference" href="#pylogrot" id="id13">[13]</a> on each of the application servers.</p>
<p>After that, we define the URL routing for our REST API by using <em>Flask</em>
decorators. For example, we will have a route <code class="docutils literal"><span class="pre">/logging/debug</span></code>,
which does nothing else but creating a log record with <code class="docutils literal"><span class="pre">DEBUG</span></code>
log level and a rather useless message. It also returns a string we
will get as a response when calling our app&#8217;s REST API.</p>
<p>At last, we run the app and let it listen on all network devices,
so it can be reached by the private IP addresses of the virtual machines.
The default port for that is <code class="docutils literal"><span class="pre">5000</span></code>.</p>
<div class="section" id="interact-with-our-app">
<h3><a class="toc-backref" href="#contents">Interact with our app</a><a class="headerlink" href="#interact-with-our-app" title="Permalink to this headline"> </a></h3>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl -X GET <span class="m">192</span>.168.78.12:5000/
Hello World!
$ curl -X GET <span class="m">192</span>.168.78.12:5000/logging/debug
Logged debug message.
$ curl -X GET <span class="m">192</span>.168.78.12:5000/logging/info
Logged info message.
$ curl -X GET <span class="m">192</span>.168.78.12:5000/logging/warning
Logged warning message
$ curl -X GET <span class="m">192</span>.168.78.13:5000/logging/info  <span class="c1"># app2 server</span>
Logged info message.
</pre></div>
</td></tr></table></div>
<p>We used <code class="docutils literal"><span class="pre">curl</span></code> to call our app&#8217;s REST API on port 5000 with the
routing we specified with <em>Flask</em>. If we did everything correct
there should be log files on the application servers:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ vagrant ssh app1 -c <span class="s2">&quot;cat /opt/example-app/app.log&quot;</span>
<span class="m">2018</span>-01-04 <span class="m">19</span>:32:24,204 - __main__ - DEBUG - debug message
<span class="m">2018</span>-01-04 <span class="m">19</span>:32:47,899 - __main__ - INFO - info message
<span class="m">2018</span>-01-04 <span class="m">19</span>:32:51,147 - __main__ - WARNING - warning message
Connection to <span class="m">127</span>.0.0.1 closed.
$
$ vagrant ssh app2 -c <span class="s2">&quot;cat /opt/example-app/app.log&quot;</span>
<span class="m">2018</span>-01-04 <span class="m">19</span>:35:36,504 - __main__ - INFO - info message
Connection to <span class="m">127</span>.0.0.1 closed.
</pre></div>
</td></tr></table></div>
<p>We see that the log file has the format as we specified in the app.</p>
</div>
<div class="section" id="search-our-log-entries">
<h3><a class="toc-backref" href="#contents">Search our log entries</a><a class="headerlink" href="#search-our-log-entries" title="Permalink to this headline"> </a></h3>
<p>Let&#8217;s use our knowledge from the previous sections to check if there
is a new <em>Index</em> created:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl -X GET <span class="m">192</span>.168.78.11:9200/_cat/indices?format<span class="o">=</span>yaml
</pre></div>
</td></tr></table></div>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">health</span><span class="p p-Indicator">:</span> <span class="s">&quot;yellow&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">status</span><span class="p p-Indicator">:</span> <span class="s">&quot;open&quot;</span>
<span class="hll">  <span class="l l-Scalar l-Scalar-Plain">index</span><span class="p p-Indicator">:</span> <span class="s">&quot;app&quot;</span>
</span>  <span class="l l-Scalar l-Scalar-Plain">uuid</span><span class="p p-Indicator">:</span> <span class="s">&quot;N6ORz3afRLWZxoogAjAYDQ&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">pri</span><span class="p p-Indicator">:</span> <span class="s">&quot;5&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">rep</span><span class="p p-Indicator">:</span> <span class="s">&quot;1&quot;</span>
<span class="hll">  <span class="l l-Scalar l-Scalar-Plain">docs.count</span><span class="p p-Indicator">:</span> <span class="s">&quot;4&quot;</span>
</span>  <span class="l l-Scalar l-Scalar-Plain">docs.deleted</span><span class="p p-Indicator">:</span> <span class="s">&quot;0&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">store.size</span><span class="p p-Indicator">:</span> <span class="s">&quot;24.3kb&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">pri.store.size</span><span class="p p-Indicator">:</span> <span class="s">&quot;24.3kb&quot;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">health</span><span class="p p-Indicator">:</span> <span class="s">&quot;yellow&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">status</span><span class="p p-Indicator">:</span> <span class="s">&quot;open&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">index</span><span class="p p-Indicator">:</span> <span class="s">&quot;my-index&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">uuid</span><span class="p p-Indicator">:</span> <span class="s">&quot;u4WB1ztWT1GVXGOI0OoJnQ&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">pri</span><span class="p p-Indicator">:</span> <span class="s">&quot;5&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">rep</span><span class="p p-Indicator">:</span> <span class="s">&quot;1&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">docs.count</span><span class="p p-Indicator">:</span> <span class="s">&quot;1&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">docs.deleted</span><span class="p p-Indicator">:</span> <span class="s">&quot;0&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">store.size</span><span class="p p-Indicator">:</span> <span class="s">&quot;4.6kb&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">pri.store.size</span><span class="p p-Indicator">:</span> <span class="s">&quot;4.6kb&quot;</span>
</pre></div>
</td></tr></table></div>
<p>Yes, there is our <strong>new index called app</strong> and our four documents are
correctly counted as well.</p>
<p>In the minimal example in a previous chapter, we had the ID to query
the document. We didn&#8217;t do that this time, as we don&#8217;t want to bother
with managing IDs when dealing with log records. We did let <em>Elasticsearch</em> assign
IDs by itself. So we need to use the <strong>search API</strong> <a class="footnote-reference" href="#essearch" id="id14">[14]</a>:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ curl -X GET <span class="m">192</span>.168.78.11:9200/app/_search?pretty<span class="o">=</span><span class="nb">true</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;took&quot;</span> <span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
  <span class="nt">&quot;timed_out&quot;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nt">&quot;_shards&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;total&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="nt">&quot;successful&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="nt">&quot;skipped&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;failed&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;hits&quot;</span> <span class="p">:</span> <span class="p">{</span>
<span class="hll">    <span class="nt">&quot;total&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span>    <span class="nt">&quot;max_score&quot;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="nt">&quot;hits&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;_index&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;Lc2rwmABVxyRMIKP804k&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_score&quot;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="hll">        <span class="nt">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
</span>          <span class="nt">&quot;timestamp&quot;</span> <span class="p">:</span> <span class="s2">&quot;2018-01-04 19:35:36,504&quot;</span><span class="p">,</span>
          <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;info message&quot;</span><span class="p">,</span>
          <span class="nt">&quot;host&quot;</span> <span class="p">:</span> <span class="s2">&quot;app2&quot;</span><span class="p">,</span>
          <span class="nt">&quot;module&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
          <span class="nt">&quot;level&quot;</span> <span class="p">:</span> <span class="s2">&quot;INFO&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;_index&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;K82pwmABVxyRMIKPYE5h&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_score&quot;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="hll">        <span class="nt">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
</span>          <span class="nt">&quot;timestamp&quot;</span> <span class="p">:</span> <span class="s2">&quot;2018-01-04 19:32:47,899&quot;</span><span class="p">,</span>
          <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;info message&quot;</span><span class="p">,</span>
          <span class="nt">&quot;host&quot;</span> <span class="p">:</span> <span class="s2">&quot;app1&quot;</span><span class="p">,</span>
          <span class="nt">&quot;module&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
          <span class="nt">&quot;level&quot;</span> <span class="p">:</span> <span class="s2">&quot;INFO&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;_index&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;LM2pwmABVxyRMIKPbU4P&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_score&quot;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="hll">        <span class="nt">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
</span>          <span class="nt">&quot;timestamp&quot;</span> <span class="p">:</span> <span class="s2">&quot;2018-01-04 19:32:51,147&quot;</span><span class="p">,</span>
          <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;warning message&quot;</span><span class="p">,</span>
          <span class="nt">&quot;host&quot;</span> <span class="p">:</span> <span class="s2">&quot;app1&quot;</span><span class="p">,</span>
          <span class="nt">&quot;module&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
          <span class="nt">&quot;level&quot;</span> <span class="p">:</span> <span class="s2">&quot;WARNING&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;_index&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_type&quot;</span> <span class="p">:</span> <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;Ks2pwmABVxyRMIKPBE5J&quot;</span><span class="p">,</span>
        <span class="nt">&quot;_score&quot;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="hll">        <span class="nt">&quot;_source&quot;</span> <span class="p">:</span> <span class="p">{</span>
</span>          <span class="nt">&quot;timestamp&quot;</span> <span class="p">:</span> <span class="s2">&quot;2018-01-04 19:32:24,204&quot;</span><span class="p">,</span>
          <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;debug message&quot;</span><span class="p">,</span>
          <span class="nt">&quot;host&quot;</span> <span class="p">:</span> <span class="s2">&quot;app1&quot;</span><span class="p">,</span>
          <span class="nt">&quot;module&quot;</span> <span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
          <span class="nt">&quot;level&quot;</span> <span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>These are the four log records we sent as documents to <em>Elasticsearch</em> with the
help of your custom logging handler in our example app.</p>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#contents">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline"> </a></h2>
<p>We set up an environment with a single-node instance of <em>Elasticsearch</em>, a data
store for documents. In our case, we use it as <strong>centralized logging store</strong>.
We used an example application to show the interaction between application
logs and the storing and querying of log records.</p>
<p>Alternatives could be a centralized logging approach with
<em>rsyslog</em> <a class="footnote-reference" href="#rsyslog" id="id15">[15]</a>. I most likely won&#8217;t do a comparison between
the two approaches.</p>
<p>The REST API of <em>Elasticsearch</em> can do much more than I showed here. For example:</p>
<ul class="simple">
<li>calculate the <code class="docutils literal"><span class="pre">_score</span></code> by providing <code class="docutils literal"><span class="pre">match</span></code> criteria</li>
<li>use clauses with <code class="docutils literal"><span class="pre">must</span></code>, <code class="docutils literal"><span class="pre">must_not</span></code> and <code class="docutils literal"><span class="pre">should</span></code></li>
<li>create aggregations with <code class="docutils literal"><span class="pre">aggs</span></code> and <code class="docutils literal"><span class="pre">avg</span></code></li>
</ul>
<p>For GUI dashboards, which show the current (and historic) state of
your environment, these REST APIs provide a lot of possibilities.
We will dive more in details when we talk about <strong>Kibana</strong>, the GUI
component of the <em>Elastic Stack</em>.</p>
<p>The next post in this series will talk about <strong>Logstash</strong>, which makes
our (shaky) custom logging handler obsolete.</p>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#contents">References</a><a class="headerlink" href="#references" title="Permalink to this headline"> </a></h2>
<table class="docutils footnote" frame="void" id="vagrinst" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="https://www.vagrantup.com/docs/installation/">https://www.vagrantup.com/docs/installation/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ansinst" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://docs.ansible.com/ansible/latest/intro_installation.html">http://docs.ansible.com/ansible/latest/intro_installation.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="vbinst" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="concepts" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/_basic_concepts.html">https://www.elastic.co/guide/en/elasticsearch/reference/6.1/_basic_concepts.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="lucene" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td><a class="reference external" href="https://lucene.apache.org/">https://lucene.apache.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="commonapi" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/common-options.html">https://www.elastic.co/guide/en/elasticsearch/reference/6.1/common-options.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="yamllist" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td><a class="reference external" href="http://www.yaml.org/spec/1.2/spec.html#id2797382">http://www.yaml.org/spec/1.2/spec.html#id2797382</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="esversion" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/docs-index_.html#index-versioning">https://www.elastic.co/guide/en/elasticsearch/reference/6.1/docs-index_.html#index-versioning</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="esindexdis" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[9]</a></td><td><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/docs-index_.html#index-creation">https://www.elastic.co/guide/en/elasticsearch/reference/6.1/docs-index_.html#index-creation</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="esindexcreate" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[10]</a></td><td><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.1/indices-create-index.html">https://www.elastic.co/guide/en/elasticsearch/reference/6.1/indices-create-index.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="flask" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[11]</a></td><td><a class="reference external" href="http://flask.pocoo.org/">http://flask.pocoo.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="pylog" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[12]</a></td><td><a class="reference external" href="https://docs.python.org/2/howto/logging.html#logging-basic-tutorial">https://docs.python.org/2/howto/logging.html#logging-basic-tutorial</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="pylogrot" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[13]</a></td><td><a class="reference external" href="https://docs.python.org/2/library/logging.handlers.html#logging.handlers.RotatingFileHandler">https://docs.python.org/2/library/logging.handlers.html#logging.handlers.RotatingFileHandler</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="essearch" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[14]</a></td><td><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/search.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="rsyslog" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15">[15]</a></td><td><a class="reference external" href="http://www.rsyslog.com/">http://www.rsyslog.com/</a></td></tr>
</tbody>
</table>
</div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  Previous: 
  <a href="../../../../2017/12/22/release-notes-with-reno/">
    
    Release Notes with reno
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
</div>

  
  
    <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'mzio';
        var disqus_identifier = '/posts/2018/01/05/elastic-stack-elk-elasticsearch/';
        var disqus_title = 'Elastic Stack (formerly ELK) - &lt;em&gt;Elasticsearch&lt;/em&gt;';
        var disqus_url = 'http://www.markusz.io/posts/2018/01/05/elastic-stack-elk-elasticsearch/';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  
  </div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015-2017, Markus Zoeller.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>